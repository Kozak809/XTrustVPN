<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    html, body { height: 100%; margin: 0; background: #16162a; }
    #map { height: 100%; width: 100%; }
    .leaflet-control-attribution { display: none; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script>
    const map = L.map('map', {
      zoomControl: false,
      attributionControl: false,
      dragging: false,
      touchZoom: false,
      doubleClickZoom: false,
      scrollWheelZoom: false,
      boxZoom: false,
      keyboard: false,
      tap: false
    }).setView([20, 0], 2);

    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
      maxZoom: 18
    }).addTo(map);

    let serverMarker = null;

    // Ensure the map is non-interactive even on top of Leaflet options
    map.getContainer().style.pointerEvents = 'none';

    function setServerLocation(lat, lon, label) {
      const ll = [lat, lon];
      if (serverMarker) {
        serverMarker.setLatLng(ll);
      } else {
        serverMarker = L.circleMarker(ll, {
          radius: 10,
          color: '#51cf66',
          weight: 3,
          fillColor: '#51cf66',
          fillOpacity: 0.25
        }).addTo(map);
      }
      if (label) {
        serverMarker.bindTooltip(label, { permanent: false, direction: 'top' }).openTooltip();
      }
      map.setView(ll, 3, { animate: true });
    }

    window.setServerLocation = setServerLocation;
  </script>
</body>
</html>
